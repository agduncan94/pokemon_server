<head>
  <title>Server Dashboard</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../styles/css-pokemon-gameboy.css">
</head>

<body style="font-family:Pokemon GB">
  <h1>Moses Lab Dashboard</h1>
  {{> serverStats}}
</body>

<template name="serverStats">
  {{#if serverStats}}

    <div class="grid grid-cols-2 grid-rows-2">
      <div class="p-4">
        <div class="framed exclude-border">
          <h3 style="font-weight: bold">{{serverStats.globalUsage.name}}</h3>
          <div class="progress-bar-container">
            <label for="progressBar">CPU Usage:{{serverStats.globalUsage.cpuUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.cpuUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">Memory Usage:{{serverStats.globalUsage.memoryUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.memoryUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">GPU Memory Usage:{{serverStats.globalUsage.gpuUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.gpuUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">Disk Usage:{{serverStats.globalUsage.diskUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.diskUsage}}"></div>
          </div>
        </div>
      </div>
      <div class="p-4">
        <img src="{{getPokemonServer serverStats.globalUsage.name}}" alt="Server Image" class="w-96 h-74 flex justify-end text-right">
      </div>
      <div class="p-4">
        <img src="{{getPokemonUser currentUser.name}}" alt="User Image" class="w-96 h-74 flex justify-end">
      </div>
      <div class="p-4">
        <div class="framed exclude-border">
          <span style="font-weight: bold">{{currentUser.name}}</span>
          <div class="progress-bar-container">
            <label for="progressBar">CPU Usage:{{currentUser.cpuUsage}}%</label>
            <div class="{{getCpuClass currentUser.cpuUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">Memory Usage:{{currentUser.memoryUsage}}%</label>
            <div class="{{getCpuClass currentUser.memoryUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">GPU Memory Usage:{{currentUser.gpuMemoryUsage}}%</label>
            <div class="{{getCpuClass currentUser.gpuMemoryUsage}}"></div>
          </div>
        </div>
      </div>
    </div>

  <h2 style="margin-top:40px">Towns</h2>
  <div id="main" class="grid grid-cols-2 gap-1 justify-evenly">
      <div class="framed exclude-border">
        <div style="margin-bottom: 15px">
          <h3 style="font-weight: bold">{{serverStats.globalUsage.name}}</h3>
          <div class="progress-bar-container">
            <label for="progressBar">CPU Usage:{{serverStats.globalUsage.cpuUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.cpuUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">Memory Usage:{{serverStats.globalUsage.memoryUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.memoryUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">GPU Memory Usage:{{serverStats.globalUsage.gpuUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.gpuUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">Disk Usage:{{serverStats.globalUsage.diskUsage}}%</label>
            <div class="{{getCpuClass serverStats.globalUsage.diskUsage}}"></div>
          </div>
        </div>
        
      {{#each serverStats.users}}
        <div style="margin-bottom: 15px">
          <span style="font-weight: bold">{{name}}</span>
          <div class="progress-bar-container">
            <label for="progressBar">CPU Usage:{{cpuUsage}}%</label>
            <div class="{{getCpuClass cpuUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">Memory Usage:{{memoryUsage}}%</label>
            <div class="{{getCpuClass memoryUsage}}"></div>
          </div>
          <div class="progress-bar-container">
            <label for="progressBar">GPU Memory Usage:{{gpuMemoryUsage}}%</label>
            <div class="{{getCpuClass gpuMemoryUsage}}"></div>
          </div>
        </div>
        {{/each}}
      </div>
    </div>

  {{else}}
    <p>Loading server stats...</p>
  {{/if}}
</template>